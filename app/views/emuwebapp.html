<!-- container for everything -->
<div ng-controller="MainCtrl" class="emuwebapp-MainCtrl" id="MainCtrl" handleglobalkeystrokes ng-style="{'font-family': cps.vals.font.fontType, 'font-size': cps.vals.font.fontPxSize}">

  <!-- left side menu bar -->
  <bundle-list-side-bar></bundle-list-side-bar>
  
  <!-- container for everything (top + bottom menu and all cans) but left sub-menu -->
  <div class="emuwebapp-mainWindow" id="mainWindow">

    <progress-thing show-thing="{{vs.somethingInProgress}}"></progress-thing>

    
    <!-- top menu bar -->
    <div class="emuwebapp-menuBarTop">
      <button ng-show="cps.vals.activeButtons.openMenu" id="submenuOpen" ng-click="openSubmenu();" class="emuwebapp-SideMenuBtn left"><img></img></button>
      <button ng-show="cps.vals.activeButtons.addLevelSeg" ng-disabled="!vs.getPermission('addLevelSegBtnClick')" class="emuwebapp-mini-btn" ng-click="addLevelSegBtnClick();">add level (SEG.)</button> 
      <button ng-show="cps.vals.activeButtons.addLevelEvent" ng-disabled="!vs.getPermission('addLevelPointBtnClick')" class="emuwebapp-mini-btn" ng-click="addLevelPointBtnClick();">add level (EVENT)</button> 
      <button ng-show="cps.vals.activeButtons.renameSelLevel" ng-disabled="!vs.getPermission('renameSelLevelBtnClick')" class="emuwebapp-mini-btn" ng-click="renameSelLevelBtnClick();">rename sel. level</button> 
      <button ng-show="cps.vals.activeButtons.downloadTextGrid" ng-disabled="!vs.getPermission('downloadTextGridBtnClick')" class="emuwebapp-mini-btn" ng-click="downloadTextGridBtnClick();">download TextGrid</button> 
      <button id="spectSettingsBtn" ng-show="cps.vals.activeButtons.specSettings" ng-disabled="!vs.getPermission('spectSettingsChange')" class="emuwebapp-mini-btn" ng-click="spectSettingsBtnClick();">spec. settings</button>

      <div class="btn-group emuwebapp-mini-btn-group" dropdown is-open="status.isopen">
        <button id="demoDB" type="button" class="dropdown-toggle" ng-show="cps.vals.activeButtons.openDemoDB" ng-disabled="!vs.getPermission('openDemoBtnDBclick')">
          open demo DB<span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li><em>Choose DB:</em></li>
          <li class="divider"></li>
          <li ng-repeat="curDB in cps.vals.demoDBs">
            <a ng-click="openDemoDBbtnClick(curDB);" id="demo{{$index}}">{{curDB}}</a>
          </li>
        </ul>
      </div>

      <button ng-show="cps.vals.activeButtons.connect" ng-disabled="!vs.getPermission('connectBtnClick')" class="emuwebapp-mini-btn" ng-click="connectBtnClick();">{{connectBtnLabel}}</button>
      <button ng-show="cps.vals.activeButtons.clear" id="clear" ng-disabled="!vs.getPermission('clearBtnClick')" class="emuwebapp-mini-btn" ng-click="clearBtnClick();">clear</button>
      <a id="aboutBtn" class="emuwebapp-SideMenuBtn2 right" title="About" ng-click="aboutBtnClick();"><img></img></a>
    </div>

    <!-- vertical split layout that contains top and bottom pane -->
    <div class="emuwebapp-allCans">
      <bg-splitter show-two-dim-cans="{{cps.vals.perspectives[vs.curPerspectiveIdx].twoDimCanvases.order.length > 0}}"> 
      <bg-pane type="topPane" min-size="80" max-size="500" class="emuwebapp-topPane">
      <div class="emuwebapp-timeline">
        <ul>
          <li ng-repeat="curTrack in cps.vals.perspectives[vs.curPerspectiveIdx].signalCanvases.order" ng-switch on="curTrack">
            <osci ng-switch-when="OSCI" order="{{$index}}" track-name="{{curTrack}}"></osci>
            <spectro ng-switch-when="SPEC" order="{{$index}}"></spectro>
            <ssff-track track-name="{{curTrack}}" ng-switch-default order="{{$index}}"></ssff-track>
          </li>
        </ul>
      </div>
    </bg-pane>
    <bg-pane type="bottomPane" min-size="80" class="emuwebapp-bottomPane">
    <div>
      <ul>
        <li ng-repeat="level in levServ.data.levels | levelsFilter" class="{{level.type}}" id="{{$index}}">
          <level id='{{level.name}}' open='true' level="level" idx="$index"></level>
        </li>
      </ul>
    </div>
  </bg-pane>
  <bg-pane type="emuwebapp-bottomRightResizePane">
  <ul>
    <li ng-repeat="cur2dTrack in cps.vals.perspectives[vs.curPerspectiveIdx].twoDimCanvases.order" ng-switch on="cur2dTrack">
      <epg ng-switch-when="EPG"></epg>
      <dots ng-switch-when="DOTS"></dots>
    </li>
  </ul>
</bg-pane>
</bg-splitter>

</div>


<!-- bottom menu bar -->
<div class="emuwebapp-menuBarBottom">
  <div ng-controller="TimelineCtrl">
    <preview id="preview" class="preview" current-bundle-name="{{curBndl.name}}"></preview>  
  </div>
  <button id="zoomAllBtn" ng-click="cmdZoomAll();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewZoomAll">all</button>
  <button id="zoomInBtn" ng-click="cmdZoomIn();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewZoomIn">in</button>
  <button id="zoomOutBtn" ng-click="cmdZoomOut();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewZoomOut">out</button>
  <button id="zoomLeftBtn" ng-click="cmdZoomLeft();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewMoveLeft">left</button>
  <button id="zoomRightBtn" ng-click="cmdZoomRight();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewMoveRight">right</button>
  <button id="zoomSelBtn" ng-click="cmdZoomSel();" ng-disabled="!vs.getPermission('zoom')" class="emuwebapp-mini-btn" id="cmd_viewZoomSelect">selection</button>
  <button id="playViewBtn" ng-show="cps.vals.restrictions.playback" ng-click="cmdPlayView();" ng-disabled="!vs.getPermission('playaudio')" class="emuwebapp-mini-btn" id="cmd_playPause">play in view</button>
  <button id="playSelBtn" ng-show="cps.vals.restrictions.playback" ng-click="cmdPlaySel();" ng-disabled="!vs.getPermission('playaudio')" class="emuwebapp-mini-btn" id="cmd_playSelected">play selected</button>
  <button id="playAllBtn" ng-show="cps.vals.restrictions.playback" ng-click="cmdPlayAll();" ng-disabled="!vs.getPermission('playaudio')" class="emuwebapp-mini-btn" id="cmd_playAll">play entire file</button>
</div>

<!-- right side menu bar -->
<nav class="emuwebapp-rightSideMenu" ng-show="cps.vals.restrictions.showPerspectivesSidebar" show-menu="vs.getRightsubmenuOpen()">
  <button class="emuwebapp-rightSideMenuOpenBtn" ng-click="toggleRightSideMenuHidden();"><img></button>
  <h3>Perspectives</h3>
  <ul>
    <li ng-repeat="persp in cps.vals.perspectives" ng-click="changePerspective(persp);" ng-class="getPerspectiveColor(persp);">{{persp.name}}</li>
  </ul>
</nav>

<!-- main window end -->
</div>
</div>
